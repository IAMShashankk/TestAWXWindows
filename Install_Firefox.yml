---
# Ansible playbook to run Windows Update and restart, if required
#
# http://docs.ansible.com/ansible/win_updates_module.html
# https://docs.ansible.com/ansible/win_reboot_module.html
- hosts: all
  tasks:
  - name: Download file from FTP with authentication
    win_reg_stat:
      path: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion
      name: CommonFilesDir
    register: common_files_dir
  - name: Download file from FTP with authentication
    win_get_url:
      url: "http://hivy/artifactory/ivy-repos/harmonic/nmx/{{common_files_dir.value}}/{{build_number}}/nmx_build_output.zip"
      dest: c:\temp\
      url_username: "{{username}}"
      url_password: "{{password}}"